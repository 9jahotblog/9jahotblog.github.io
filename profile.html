<!DOCTYPE HTML>
<html>
<head>
    <title>My 9jahotblog Profile</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
    <link rel="stylesheet" href="assets/css/main.css" />
    <noscript>
        <link rel="stylesheet" href="assets/css/noscript.css" />
    </noscript>
    <style>
        body {
            transition: background-color 0.5s, color 0.5s;
        }

        .profile-container,
        .writing-container,
        .book-reader-container,
        .library-container {
            text-align: center;
            background-color: #111111;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            max-width: 600px;
            margin: auto;
            margin-top: 20px;
            position: relative;
            color: #fff;
            font-family: 'Arial', sans-serif;
        }

        .profile-container img {
            border-radius: 50%;
            width: 80px;
            height: 80px;
        }

        .profile-container button,
        .writing-container button,
        .book-reader-container button,
        .theme-toggle {
            margin-top: 10px;
            background-color: #444;
            color: white;
            border: none;
            padding: 10px 20px;
            cursor: pointer;
            border-radius: 5px;
            transition: background-color 0.3s;
        }

        .writing-container textarea {
            width: 100%;
            height: 200px;
            margin-top: 10px;
            padding: 10px;
            border-radius: 4px;
            border: 1px solid #ccc;
        }

        .library-container img {
            width: 100px;
            height: 150px;
            margin: 10px;
            cursor: pointer;
        }

        .theme-toggle {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #444;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
        }

        #dark-mode-toggle {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background-color: #444;
            color: white;
            border: none;
            padding: 10px;
            border-radius: 50%;
            cursor: pointer;
        }

        footer {
            margin-top: 40px;
        }
    </style>
</head>

<body class="is-preload landing">
    <div id="page-wrapper">

        <!-- Header -->
        <header id="header">
            <h1 id="logo"><a href="index.html">9JAHOTBLOG</a></h1>
            <nav id="nav">
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="#writing-section">Publish Story</a></li>
                    <li><a href="#profile-section">Profile</a></li>
                    <li><a href="#library-section">Featured Story of the Month</a></li>
                    <li><a href="#benefits-section">Profile Benefits</a></li>
                </ul>
            </nav>
        </header>

        <!-- Main -->
        <div id="main" class="wrapper style1">
            <div class="container">
                <header class="major">
                    <h1>Welcome to 9jahotblog Storybooks, <span id="user-name"></span>!</h1>
                </header>

                <!-- Profile Section -->
                <section id="profile-section">
                    <div class="profile-container">
                        <button class="theme-toggle">ðŸŒ™</button>
                        <div>
                            <img id="profile-photo" src="https://via.placeholder.com/100" alt="Profile Picture" />
                        </div>
                        <p>Email: <span id="user-email"></span></p>
                        <p>Username: <span id="user-username"></span></p>
                        <p>Earnings: â‚¦0.00</p>
                        <p>Short Stories/Articles: N/A</p>
                        <p>Books: N/A</p>
                        <p>Level: <span id="user-level">9jahotblogger</span></p>
                        <button id="edit-profile">Edit Profile</button>
                        <button id="logout">Logout</button>
                    </div>
                    <hr />
                </section>

                <!-- Library Section -->
                <section id="library-section">
                    <div class="library-container">
                        <h2>Featured Story of the Month</h2>
                        <img src="https://i.postimg.cc/VvSVHH3N/1722646756851.jpg" alt="Lone Ranger" style="border-radius: 0;" />
                        <h3>Lone Ranger</h3>
                        <p>by Praise Abraham</p>
                    </div>
                </section>

                <!-- Book Reader Section -->
<section id="book-reader-section">
    <div class="book-reader-container">
        <button class="theme-toggle">ðŸŒ™</button>
        <h2>Book Reader</h2>
        <div id="book-content">
            <p id="book-page"></p>
        </div>
        <button id="prev-page">Previous</button>
        <button id="next-page">Next</button>
    </div>
</section>


                <!-- Writing Prompt and Textbox Section -->
                <section id="writing-section">
                    <div class="writing-container">
                        <button class="theme-toggle">ðŸŒ™</button>
                        <form action="https://formspree.io/f/mldrbpwo" method="POST">
                            <h2>Writing Prompt</h2>
                            <p id="writing-prompt">Click the button to get a new prompt!</p>
                            <button type="button" id="new-prompt-btn">New Prompt</button>
                            <textarea id="writing-textbox" name="content" placeholder="Start writing here..."></textarea>
                            <p id="word-count">Word count: 0</p>
                            <p id="congratulatory-message"></p>
                            <button type="submit" id="publish-story">Publish Story</button>
                        </form>
                    </div>
                </section>

                <!-- Text-to-Speech Section-->
                  
            <section id="tts-section">
    <div class="profile-container">
        <h2>9jahotblog Audiobook Ai</h2>
        <div id="tts-input" contenteditable="true" style="width: 100%; height: 200px; border: 1px solid #ccc; margin-bottom: 10px; overflow-y: scroll;"></div>
        <div>
            <button id="convert-speech">Convert to Speech</button>
            <button id="pause-speech">Pause</button>
            <button id="continue-speech">Continue</button>
            <button id="stop-speech">Stop</button>
            <button id="download-speech">Download Audio</button>
            <button id="download-text">Download Text</button>
        </div>
    </div>
</section>

<script>
    let utterances = [];
    let currentIndex = 0;
    let mediaRecorder;
    let audioChunks = [];

    // Function to highlight spoken text
    function highlightSpokenText(text, utterance) {
        let currentIndex = 0;
        const words = text.split(' ');

        utterance.onboundary = function(event) {
            if (event.name === 'word') {
                const span = document.createElement('span');
                span.style.backgroundColor = 'black'; // Darker background
                span.style.color = 'white'; // White text
                span.textContent = words[currentIndex] + ' ';
                words[currentIndex] = span.outerHTML;
                document.getElementById('tts-input').innerHTML = words.join(' ');
                currentIndex++;

                // Scroll to the highlighted word
                const ttsInput = document.getElementById('tts-input');
                const highlightedWord = ttsInput.querySelector('span[style*="background-color: black;"]');
                if (highlightedWord) {
                    ttsInput.scrollTop = highlightedWord.offsetTop - ttsInput.offsetTop;
                }
            }
        };
    }

    // Function to create and configure a SpeechSynthesisUtterance
    function createUtterance(text, voice) {
        const msg = new SpeechSynthesisUtterance(text);
        msg.voice = voice; // Voice configuration
        return msg;
    }

    // Function to speak text with selected voice
    function speakText(voice) {
        const text = document.getElementById('tts-input').innerText;

        if (text.trim() !== "") {
            const utterance = createUtterance(text, voice);
            utterance.onend = () => {
                if (mediaRecorder && mediaRecorder.state !== 'inactive') {
                    mediaRecorder.stop();
                }
            };

            highlightSpokenText(text, utterance);
            window.speechSynthesis.speak(utterance);

            // Start recording audio
            if (mediaRecorder && mediaRecorder.state === 'inactive') {
                mediaRecorder.start();
            }
        } else {
            alert("Please enter some text to convert to speech.");
        }
    }

    // Function to handle audio recording
    function startRecording() {
        audioChunks = [];
        navigator.mediaDevices.getUserMedia({ audio: true }).then(stream => {
            mediaRecorder = new MediaRecorder(stream, { mimeType: 'audio/webm' });

            mediaRecorder.ondataavailable = event => {
                if (event.data.size > 0) {
                    audioChunks.push(event.data);
                }
            };

            mediaRecorder.onstop = () => {
                const audioBlob = new Blob(audioChunks, { type: 'audio/webm' });
                const audioUrl = URL.createObjectURL(audioBlob);
                const a = document.createElement('a');
                a.style.display = 'none';
                a.href = audioUrl;
                a.download = 'spoken_audio.webm';
                document.body.appendChild(a);
                a.click();
                URL.revokeObjectURL(audioUrl);
            };
        });
    }

    // Function to download text input
    function downloadTextInput() {
        const text = document.getElementById('tts-input').innerText;
        if (text.trim() !== "") {
            const textToSave = text + "\n\nGenerated by 9jahotblog Storybooks";
            const textBlob = new Blob([textToSave], { type: 'text/plain' });
            const textUrl = URL.createObjectURL(textBlob);
            const a = document.createElement('a');
            a.style.display = 'none';
            a.href = textUrl;
            a.download = 'input_text.txt';
            document.body.appendChild(a);
            a.click();
            URL.revokeObjectURL(textUrl);
        } else {
            alert("Please enter some text to download.");
        }
    }

    // Load voices and configure voice options
    function loadVoices() {
        const voices = window.speechSynthesis.getVoices();
        return voices[0] || null; // Default to the first available voice
    }

    // Event listeners for TTS buttons
    document.getElementById('convert-speech').addEventListener('click', () => {
        window.speechSynthesis.cancel();
        startRecording();
        const voice = loadVoices();
        if (voice) {
            speakText(voice);
        } else {
            alert("No voice available for speech synthesis.");
        }
    });

    document.getElementById('pause-speech').addEventListener('click', () => {
        window.speechSynthesis.pause();
        if (mediaRecorder && mediaRecorder.state === 'recording') {
            mediaRecorder.pause();
        }
    });

    document.getElementById('continue-speech').addEventListener('click', () => {
        window.speechSynthesis.resume();
        if (mediaRecorder && mediaRecorder.state === 'paused') {
            mediaRecorder.resume();
        }
    });

    document.getElementById('stop-speech').addEventListener('click', () => {
        window.speechSynthesis.cancel();
        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
            mediaRecorder.stop();
        }
    });

    document.getElementById('download-speech').addEventListener('click', () => {
        if (mediaRecorder && mediaRecorder.state !== 'inactive') {
            mediaRecorder.stop();
        } else {
            alert("No audio to download. Please convert text to speech first.");
        }
    });

    document.getElementById('download-text').addEventListener('click', () => {
        downloadTextInput();
    });

    // Load voices when the voices are loaded
    window.speechSynthesis.onvoiceschanged = loadVoices;

    document.addEventListener("DOMContentLoaded", function() {
        if (window.speechSynthesis.onvoiceschanged !== undefined) {
            window.speechSynthesis.onvoiceschanged = loadVoices;
        }
    });
</script>

            
    
    <style>
        body.dark-theme {
            background-color: #121212;
            color: #ffffff;
        }
        .dark-theme .profile-container {
            background-color: #1e1e1e;
            border-color: #333;
        }
        .dark-theme #game-display,
        .dark-theme #chat-box {
            background-color: #2e2e2e;
            border-color: #444;
        }
        .dark-theme input,
        .dark-theme textarea {
            background-color: #3e3e3e;
            color: #fff;
            border-color: #555;
        }
        .dark-theme button {
            background-color: #444;
            color: #fff;
            border-color: #555;
        }
    </style>
                
    <!-- Menu Section -->
    <section id="menu" style="display: block;">
        <h1>Welcome to 9jahotblog Storybooks</h1>
        <p>Select a mysterious story:</p>
        <strong>Title: Solve an investigation, uncover secrets, and win data and amazing prizes!</strong>
        <p>As you advance, genres and stories change weekly or daily.</p>
        <button class="story-choice" data-story="1">The Haunted Manor</button>
        <button class="story-choice" data-story="2">The Secret Laboratory</button>
        <button class="story-choice" data-story="3">The Missing Artifact</button>
        <button class="story-choice" data-story="4">The Cursed Treasure</button>
        <button class="story-choice" data-story="5">The Hidden Gallery</button>
    </section>

    <!-- Mystery Writer Challenge Section -->
    <section id="mystery-writer" style="display: none;">
        <div class="profile-container">
            <button class="theme-toggle">ðŸŒ™</button>
            <h2>Mysterious Game!</h2>
            <p id="intro">Hello, <span id="user-username"></span>! Welcome to the Mystery Writer Challenge. I'm the mysterious 9jahotblog AI, your assistant through this exciting game. Your mission is to uncover the secrets hidden within these mysteries.</p>
            <div id="game-display" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;"></div>
            <textarea id="user-input" placeholder="Type your response here..." style="width: 100%; height: 100px; margin-bottom: 10px;"></textarea>
            <div>
                <button id="submit-challenge">Submit</button>
                <button id="next-level" style="display: none;">Next Level</button>
            </div>
            <div id="feedback" style="margin-top: 10px;"></div>
            <div id="final-message" style="display: none;">
                <p>Congratulations, you've completed this level of the challenge! Would you like to continue or stop and win 20MB data?</p>
                <button id="continue-game">Continue</button>
                <button id="stop-game">Stop and Win 20MB Data</button>
                <button id="next-section">Next Section</button>
            </div>
            <div id="end-game" style="display: none;">
                <p>You just won 200MB worth of data! You're a writing machine! Click <a href="https://wa.me/+2349160331432" target="_blank">here</a> to claim your prize. Remember to screenshot this page and send it to support for verification.</p>
            </div>
            <div id="user-responses-container" style="margin-top: 20px;">
                <h3>Your Story Progress:</h3>
                <div id="user-responses"></div>
            </div>
            <div id="download-link" style="margin-top: 10px;">
                <button id="download-txt">Download Story TXT</button>
                <button id="download-word">Download Story Word</button>
                <button id="download-pdf">Download Story PDF</button>
                <button id="download-all">Download All Responses</button>
            </div>
        </div>
    </section>

    <script>
        // Story Data
        const stories = {
            1: [
                { prompt: "Level 1: You find yourself standing before a haunted manor. The air is thick with mystery. What do you do first?", successKeywords: ['enter', 'explore', 'investigate'], failureMessage: "You hesitate at the door and miss your chance.", successMessage: "You bravely enter the manor and begin your investigation. ðŸ•µï¸â€â™‚ï¸ðŸšï¸" },
                { prompt: "Level 2: Inside, you hear eerie sounds coming from the basement. What's your next move?", successKeywords: ['descend', 'investigate', 'explore'], failureMessage: "You stay frozen in fear.", successMessage: "You gather your courage and descend into the basement. ðŸ§Ÿâ€â™‚ï¸ðŸ”¦" },
                { prompt: "Level 3: The basement reveals a hidden passage. What do you do?", successKeywords: ['enter', 'explore', 'follow'], failureMessage: "You turn back, missing the adventure ahead.", successMessage: "You enter the passage and discover hidden secrets. ðŸ•µï¸â€â™€ï¸ðŸ—ï¸" },
                { prompt: "Level 4: You find an old diary that hints at a family curse. What's your next step?", successKeywords: ['read', 'investigate', 'uncover'], failureMessage: "You dismiss the diary as irrelevant.", successMessage: "You uncover the curse's origins by reading the diary. ðŸ“–ðŸ”®" },
                { prompt: "Level 5: The curse can only be lifted by a special ritual. Describe your actions.", successKeywords: ['perform', 'ritual', 'chant'], failureMessage: "You fail to act in time.", successMessage: "You perform the ritual and lift the curse. âœ¨ðŸ•¯ï¸" }
            ],
            2: [
                { prompt: "Level 1: You discover a secret laboratory hidden beneath your school. What do you do first?", successKeywords: ['explore', 'enter', 'investigate'], failureMessage: "You ignore it and walk away.", successMessage: "You enter the lab and start exploring. ðŸ§ªðŸ”" },
                { prompt: "Level 2: Inside, you find a mysterious device. How do you handle it?", successKeywords: ['examine', 'analyze', 'use'], failureMessage: "You leave it untouched.", successMessage: "You analyze the device and uncover its purpose. ðŸ”¬ðŸ“Ÿ" },
                { prompt: "Level 3: The device leads you to a hidden experiment. What do you do next?", successKeywords: ['investigate', 'experiment', 'research'], failureMessage: "You ignore the experiment.", successMessage: "You delve into the experiment and make a breakthrough. ðŸ§«ðŸ’¡" },
                { prompt: "Level 4: You find a journal detailing dangerous plans. What's your action?", successKeywords: ['read', 'stop', 'expose'], failureMessage: "You ignore the journal.", successMessage: "You read the journal and plan to expose the plot. ðŸ“”ðŸ›‘" },
                { prompt: "Level 5: You must stop the experiment before it's too late. Describe your approach.", successKeywords: ['stop', 'destroy', 'sabotage'], failureMessage: "You fail to act in time.", successMessage: "You stop the experiment and save the day. âš—ï¸ðŸš¨" }
            ],
            3: [
                { prompt: "Level 1: An ancient artifact is stolen from a museum. Where do you start your investigation?", successKeywords: ['interrogate', 'search', 'investigate'], failureMessage: "You waste time looking in the wrong places.", successMessage: "You start your investigation and gather crucial clues. ðŸºðŸ•µï¸â€â™‚ï¸" },
                { prompt: "Level 2: The clues lead you to a shady warehouse. What do you do?", successKeywords: ['enter', 'search', 'investigate'], failureMessage: "You hesitate and lose the trail.", successMessage: "You search the warehouse and find more clues. ðŸšï¸ðŸ”" },
                { prompt: "Level 3: You uncover a hidden room in the warehouse. What's your next move?", successKeywords: ['enter', 'explore', 'investigate'], failureMessage: "You leave without investigating.", successMessage: "You explore the hidden room and find the artifact. ðŸ—ï¸ðŸº" },
                { prompt: "Level 4: The artifact is cursed. How do you handle it?", successKeywords: ['examine', 'research', 'neutralize'], failureMessage: "You ignore the curse.", successMessage: "You research and neutralize the curse. ðŸ“œðŸ”®" },
                { prompt: "Level 5: You need to return the artifact to its rightful place. Describe your actions.", successKeywords: ['return', 'restore', 'place'], failureMessage: "You fail to return the artifact.", successMessage: "You successfully return the artifact and lift the curse. ðŸºâœ¨" }
            ],
            4: [
                { prompt: "Level 1: A map leads you to a cursed treasure hidden on an island. How do you begin?", successKeywords: ['sail', 'explore', 'search'], failureMessage: "You get lost at sea.", successMessage: "You sail to the island and start your search. â›µðŸï¸" },
                { prompt: "Level 2: The island is full of traps. What's your strategy?", successKeywords: ['navigate', 'avoid', 'disarm'], failureMessage: "You fall victim to a trap.", successMessage: "You carefully navigate the traps and move forward. ðŸ—ºï¸ðŸš§" },
                { prompt: "Level 3: You find a hidden cave. What will you do?", successKeywords: ['enter', 'explore', 'investigate'], failureMessage: "You ignore the cave and continue searching elsewhere.", successMessage: "You enter the cave and discover clues to the treasure's location. ðŸ•µï¸â€â™‚ï¸ðŸ—ï¸" },
                { prompt: "Level 4: Inside the cave, you encounter a guardian creature. How do you handle it?", successKeywords: ['negotiate', 'sneak', 'fight'], failureMessage: "You are overpowered by the creature.", successMessage: "You successfully negotiate with the creature or sneak past it. ðŸ‰ðŸ¤" },
                { prompt: "Level 5: You finally reach the treasure. What do you do?", successKeywords: ['open', 'take', 'examine'], failureMessage: "You misjudge the situation and set off a trap.", successMessage: "You safely open the treasure chest and secure your prize. ðŸ’°ðŸ†" }
            ],
            5: [
                { prompt: "Level 1: You receive a mysterious invitation to a hidden gallery. How do you proceed?", successKeywords: ['accept', 'explore', 'investigate'], failureMessage: "You decline the invitation and miss out on the mystery.", successMessage: "You accept the invitation and enter the gallery. ðŸ–¼ï¸ðŸ”" },
                { prompt: "Level 2: The gallery is filled with strange and magical artifacts. What's your approach?", successKeywords: ['examine', 'catalog', 'research'], failureMessage: "You overlook key details.", successMessage: "You carefully examine the artifacts and find hidden clues. ðŸ§©ðŸ§³" },
                { prompt: "Level 3: You discover a hidden room in the gallery. What do you do next?", successKeywords: ['enter', 'explore', 'investigate'], failureMessage: "You ignore the hidden room and miss important clues.", successMessage: "You explore the hidden room and find significant evidence. ðŸ•µï¸â€â™€ï¸ðŸ”Ž" },
                { prompt: "Level 4: The evidence leads you to a secret painting with a hidden message. What do you do?", successKeywords: ['decode', 'examine', 'analyze'], failureMessage: "You misinterpret the message.", successMessage: "You decode the message and uncover a new mystery. ðŸŽ¨ðŸ—ï¸" },
                { prompt: "Level 5: The message reveals a hidden location for a final prize. Describe how you uncover it.", successKeywords: ['search', 'find', 'reveal'], failureMessage: "You fail to locate the final prize.", successMessage: "You find the hidden location and claim the final prize. ðŸŽðŸ…" }
            ]
        };

        document.addEventListener('DOMContentLoaded', () => {
            const menu = document.getElementById('menu');
            const mysteryWriter = document.getElementById('mystery-writer');
            const gameDisplay = document.getElementById('game-display');
            const userResponses = document.getElementById('user-responses');
            const userInput = document.getElementById('user-input');
            const submitChallenge = document.getElementById('submit-challenge');
            const nextLevel = document.getElementById('next-level');
            const finalMessage = document.getElementById('final-message');
            const endGame = document.getElementById('end-game');
            const downloadTxt = document.getElementById('download-txt');
            const downloadWord = document.getElementById('download-word');
            const downloadPdf = document.getElementById('download-pdf');
            const downloadAll = document.getElementById('download-all');
            const storyChoices = document.querySelectorAll('.story-choice');
            let currentStory;
            let currentLevel = 0;
            let responses = [];

            function startStory(storyId) {
                currentStory = stories[storyId];
                currentLevel = 0;
                responses = [];
                menu.style.display = 'none';
                mysteryWriter.style.display = 'block';
                showPrompt();
            }

            function showPrompt() {
                if (currentLevel < currentStory.length) {
                    const promptData = currentStory[currentLevel];
                    gameDisplay.innerHTML = `<p>${promptData.prompt}</p>`;
                    userInput.value = '';
                    submitChallenge.style.display = 'block';
                    nextLevel.style.display = 'none';
                    finalMessage.style.display = 'none';
                } else {
                    gameDisplay.innerHTML = '<p>Congratulations! You have completed this story. Choose what to do next:</p>';
                    submitChallenge.style.display = 'none';
                    nextLevel.style.display = 'none';
                    finalMessage.style.display = 'block';
                }
            }

            function handleUserResponse() {
                const userText = userInput.value.toLowerCase();
                const promptData = currentStory[currentLevel];
                let success = false;

                if (promptData.successKeywords.some(keyword => userText.includes(keyword))) {
                    gameDisplay.innerHTML = `<p>${promptData.successMessage}</p>`;
                    success = true;
                } else {
                    gameDisplay.innerHTML = `<p>${promptData.failureMessage}</p>`;
                }

                responses.push({
                    level: currentLevel + 1,
                    response: userText,
                    result: success ? 'Success' : 'Failure'
                });

                if (success) {
                    nextLevel.style.display = 'block';
                } else {
                    submitChallenge.style.display = 'none';
                }
            }

            function handleContinue() {
                currentLevel++;
                showPrompt();
            }

            function handleStopGame() {
                mysteryWriter.style.display = 'none';
                endGame.style.display = 'block';
            }

            function handleNextSection() {
                menu.style.display = 'block';
                mysteryWriter.style.display = 'none';
                endGame.style.display = 'none';
            }

            function downloadFile(content, fileName, mimeType) {
                const blob = new Blob([content], { type: mimeType });
                const url = URL.createObjectURL(blob);
                const link = document.createElement('a');
                link.href = url;
                link.download = fileName;
                link.click();
                URL.revokeObjectURL(url);
            }

            function downloadResponses(format) {
                let content = '';
                responses.forEach(response => {
                    content += `Level ${response.level}: ${response.response} - ${response.result}\n`;
                });

                if (format === 'txt') {
                    downloadFile(content, 'responses.txt', 'text/plain');
                } else if (format === 'docx') {
                    // Generate Word file
                    // Implement Word generation here (e.g., using a library like docx.js)
                } else if (format === 'pdf') {
                    // Generate PDF file
                    // Implement PDF generation here (e.g., using a library like jsPDF)
                }
            }

            storyChoices.forEach(button => {
                button.addEventListener('click', () => {
                    startStory(button.getAttribute('data-story'));
                });
            });

            submitChallenge.addEventListener('click', handleUserResponse);
            nextLevel.addEventListener('click', handleContinue);
            document.getElementById('stop-game').addEventListener('click', handleStopGame);
            document.getElementById('next-section').addEventListener('click', handleNextSection);

            downloadTxt.addEventListener('click', () => downloadResponses('txt'));
            downloadWord.addEventListener('click', () => downloadResponses('docx'));
            downloadPdf.addEventListener('click', () => downloadResponses('pdf'));
            downloadAll.addEventListener('click', () => {
                // Implement download all responses
                // Concatenate all responses and offer as a download
            });
        });
    </script>

              <!-- Character Creation Section -->
<section id="character-creation" style="display: block;">
    <div class="profile-container">
        <button class="theme-toggle">ðŸŒ™</button>
        <h2>Character Creation Challenge</h2>
        <p id="char-intro">Welcome to the Character Creation Game! ðŸŽ¨âœ¨ Your mission is to create a character with unique traits and skills by making critical decisions through various levels. Ready to start?</p>
        
        <div id="char-game-display" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;"></div>
        <textarea id="char-user-input" placeholder="Type your choice here..." style="width: 100%; height: 100px; margin-bottom: 10px;"></textarea>
        
        <div>
            <button id="char-submit-choice">Submit Choice</button>
            <button id="char-next-level" style="display: none;">Next Level</button>
        </div>
        
        <div id="char-feedback" style="margin-top: 10px;"></div>
        <div id="char-summary" style="display: none;">
            <p>Congratulations! ðŸŽ‰ You've completed the Character Creation Challenge. Review your character's profile below:</p>
            <div id="char-profile"></div>
            <button id="download-char-profile">Download Character Profile</button>
        </div>
        
    </div>
</section>

<script>
    // Character Creation Data
    const characterLevels = [
        { prompt: "Level 1: Choose your characterâ€™s background. Will they be a Noble, Merchant, or Adventurer?", successKeywords: ['noble', 'merchant', 'adventurer'], failureMessage: "You didn't make a choice, and your character's background remains unclear.", successMessage: "You have chosen a background for your character!" },
        { prompt: "Level 2: Pick a special skill for your character. Will they be skilled in Magic, Combat, or Diplomacy?", successKeywords: ['magic', 'combat', 'diplomacy'], failureMessage: "You failed to choose a skill, and your character lacks focus.", successMessage: "Your character now has a special skill!" },
        { prompt: "Level 3: Choose a defining trait. Will your character be Brave, Wise, or Cunning?", successKeywords: ['brave', 'wise', 'cunning'], failureMessage: "You missed selecting a defining trait, leaving your character's personality vague.", successMessage: "You've defined a key trait of your character!" },
        { prompt: "Level 4: Decide on an important goal for your character. Will they seek Wealth, Knowledge, or Power?", successKeywords: ['wealth', 'knowledge', 'power'], failureMessage: "You didn't set a goal, and your character lacks direction.", successMessage: "Your character now has a clear goal!" },
        { prompt: "Level 5: Finalize your characterâ€™s name and appearance. What will your character be called and look like?", successKeywords: ['name', 'description'], failureMessage: "You didn't provide a name or description, leaving your character incomplete.", successMessage: "You've given your character a name and appearance!" }
    ];

    let currentLevel = 0;
    
    function displayLevel(levelIndex) {
        const level = characterLevels[levelIndex];
        document.getElementById('char-game-display').innerHTML = `<p>${level.prompt}</p>`;
        document.getElementById('char-submit-choice').style.display = 'block';
        document.getElementById('char-next-level').style.display = 'none';
    }

    document.getElementById('char-submit-choice').addEventListener('click', function() {
        const userInput = document.getElementById('char-user-input').value.toLowerCase();
        const level = characterLevels[currentLevel];
        if (level.successKeywords.includes(userInput)) {
            document.getElementById('char-feedback').innerHTML = `<p>Success! ${level.successMessage}</p>`;
            currentLevel++;
            if (currentLevel < characterLevels.length) {
                document.getElementById('char-next-level').style.display = 'block';
            } else {
                document.getElementById('char-summary').style.display = 'block';
                document.getElementById('char-feedback').innerHTML = `<p>You've completed all levels! ${level.successMessage}</p>`;
                // Logic to show character profile
                document.getElementById('char-profile').innerHTML = "Your character profile details...";
                document.getElementById('download-char-profile').style.display = 'block';
            }
        } else {
            document.getElementById('char-feedback').innerHTML = `<p>Failure. ${level.failureMessage}</p>`;
        }
    });

    document.getElementById('char-next-level').addEventListener('click', function() {
        displayLevel(currentLevel);
    });

    displayLevel(currentLevel);
</script>
    
                <!-- Chat Section -->
                <section id="chat-section">
                    <div class="profile-container">
                        <button class="theme-toggle">ðŸŒ™</button>
                        <h2>9jahotblog Chat AI</h2>
                        <div id="chat-box" style="height: 300px; overflow-y: scroll; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px;">
                            <div id="chat-messages"></div>
                        </div>
                        <input type="text" id="chat-input" placeholder="Type your message here..." style="width: 80%;">
                        <button id="send-message">Send</button>
                    </div>
                </section>
    
                  <script> 
                   document.getElementById('send-message').addEventListener('click', () => {
    const chatInput = document.getElementById('chat-input');
    const chatMessages = document.getElementById('chat-messages');
    const userMessage = chatInput.value.trim();

    if (userMessage === '') {
        return;
    }

    // Add user message to chat
    const userMessageElement = document.createElement('div');
    userMessageElement.textContent = `You: ${userMessage}`;
    chatMessages.appendChild(userMessageElement);

    // Clear input
    chatInput.value = '';

    // Simulate AI response (Replace this part with actual AI response logic if available)
    setTimeout(() => {
        const aiResponse = `AI: I'm here to assist you, ${userMessage}`;
        const aiMessageElement = document.createElement('div');
        aiMessageElement.textContent = aiResponse;
        chatMessages.appendChild(aiMessageElement);

        // Scroll to the bottom of the chat box
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }, 1000);
});

// Theme toggle functionality
document.querySelectorAll('.theme-toggle').forEach(button => {
    button.addEventListener('click', () => {
        document.body.classList.toggle('dark-theme');
    });
});

// Optional: Handle Enter key press to send message
document.getElementById('chat-input').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') {
        document.getElementById('send-message').click();
    }
});
                  </script>

        

                <!-- Text-to-Speech Section with Third-Party TTS Integration -->
<section id="tts-section">
    <div class="profile-container">
        <h2>Text-to-Speech</h2>
        <div id="tts-input" contenteditable="true" style="width: 100%; height: 200px; border: 1px solid #ccc; margin-bottom: 10px; overflow-y: scroll;"></div>
        <div>
            <button id="convert-speech">Convert to Speech</button>
            <button id="pause-speech">Pause</button>
            <button id="continue-speech">Continue</button>
            <button id="stop-speech">Stop</button>
        </div>
    </div>
</section>

<script>
    let audioContext;
    let source;
    let isPaused = false;
    let audioBuffer;

    // Function to highlight spoken text
    function highlightSpokenText(text) {
        const words = text.split(' ');
        let currentIndex = 0;

        const interval = setInterval(() => {
            if (currentIndex < words.length) {
                const span = document.createElement('span');
                span.style.backgroundColor = 'yellow';
                span.textContent = words[currentIndex] + ' ';
                words[currentIndex] = span.outerHTML;
                document.getElementById('tts-input').innerHTML = words.join(' ');

                const ttsInput = document.getElementById('tts-input');
                const highlightedWord = ttsInput.querySelector('span[style="background-color: yellow;"]');
                if (highlightedWord) {
                    ttsInput.scrollTop = highlightedWord.offsetTop - ttsInput.offsetTop;
                }

                currentIndex++;
            } else {
                clearInterval(interval);
            }
        }, 200); // Adjust the interval as needed
    }

    // Function to fetch and play TTS audio
    async function fetchAndPlayTTS(text) {
        const apiKey = 'AIzaSyCd_P4J5xgsXcyVaqUBtAHvhb1AWJUATvA';
        const url = `https://texttospeech.googleapis.com/v1beta1/text:synthesize`;
        
        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json'
            },
            body: JSON.stringify({
                input: { text: text },
                voice: { languageCode: 'en-US', ssmlGender: 'NEUTRAL' },
                audioConfig: { audioEncoding: 'MP3' }
            })
        });

        const data = await response.json();
        const audioContent = data.audioContent;
        const audioString = `data:audio/mp3;base64,${audioContent}`;

        audioContext = new (window.AudioContext || window.webkitAudioContext)();
        const responseAudio = await fetch(audioString);
        const arrayBuffer = await responseAudio.arrayBuffer();
        audioBuffer = await audioContext.decodeAudioData(arrayBuffer);

        playAudio();
        highlightSpokenText(text);
    }

    // Function to play audio
    function playAudio() {
        source = audioContext.createBufferSource();
        source.buffer = audioBuffer;
        source.connect(audioContext.destination);
        source.start(0);
    }

    // Event listeners for TTS buttons
    document.getElementById('convert-speech').addEventListener('click', () => {
        const text = document.getElementById('tts-input').innerText;
        if (text.trim() !== "") {
            fetchAndPlayTTS(text);
        } else {
            alert("Please enter some text to convert to speech.");
        }
    });

    document.getElementById('pause-speech').addEventListener('click', () => {
        if (audioContext && audioContext.state === 'running') {
            audioContext.suspend();
            isPaused = true;
        }
    });

    document.getElementById('continue-speech').addEventListener('click', () => {
        if (audioContext && isPaused) {
            audioContext.resume();
            isPaused = false;
        }
    });

    document.getElementById('stop-speech').addEventListener('click', () => {
        if (source) {
            source.stop();
        }
    });
</script>
            

                <!-- Profile Benefits Section -->
                <section id="benefits-section">
                    <div class="profile-container">
                        <button class="theme-toggle">ðŸŒ™</button>
                        <h2>Profile Benefits</h2>

                        <p>As a 9jahotblogger, you enjoy numerous benefits that elevate your writing experience and expand your reach. A detailed look at some of the incredible advantages you gain:</p>

                        <h3>Search Result Priority.</h3>
                        <p>Enjoy prioritized ranking in search results on both 9jahotblog, Google, and more.. Ensuring your content reaches a wider audience.</p>

                        <h3>Adaptations.</h3>
                        <p>Get free credits to adapt your book into a movie, create a marketing video, or movie trailer for your stories. Offering a significant boost to your creative career. For more information, <a href="https://9jahotblog.github.io/create-book-trailers-images-or-movies.html">Click here</a></p>

                        <h3>Exclusive Contests..</h3>
                        <p>Participate in exclusive contests that provide unique opportunities to showcase your talent and win exciting prizes.</p>

                        <h3>Monetization..</h3>
                        <p>Earn money from posting short stories and engaging your audience. Increased engagements lead to earnings.</p>

                        <h3>Analytics Tracking..</h3>
                        <p>Track the analytics of your posts by checking the post link page, allowing you to monitor and optimize your content's performance. There, you can see how your post is doing, feedbacks, earnings and more.. Can't wait to find out? Post today and share the links to get started!</p>

            <h3>Verified Badge..</h3>
            <p>Gain a verified badge after amassing significant engagements on your posts, enhancing your credibility and visibility, not only on 9jahotblog.</p>

            <h3>Introducing the 9jahotblog Verified Badge
                <img src="https://i.postimg.cc/YqZKVx4v/IMG-20240803-WA0027.jpg" alt="9jahotblog Verified Badge" style="width:25px;height:25px;vertical-align:middle;margin-right:5px;"></h3>
            <p>The 9jahotblog verified badge appears next to a person's username, indicating their profile is authentic and notable. They've posted multiple times and they've gained massive engagements and exposure.</p>
            <p>Users with a verified badge have access to additional features, such as:</p>

            <h3>AI Writing Assistant
                <img src="https://i.postimg.cc/YqZKVx4v/IMG-20240803-WA0027.jpg" alt="9jahotblog Verified Badge" style="width:25px;height:25px;vertical-align:middle;margin-right:5px;"></h3>
            <p>An AI assistant integrated here to evaluate writing, check grammar and spelling, ensuring your posts are polished and professional. Basically for rating, spelling check, image generation and more.. Users can also choose social media channel they want the bot to be. (Telegram&here Default)</p>

            <h3>Enhanced Earnings
                <img src="https://i.postimg.cc/YqZKVx4v/IMG-20240803-WA0027.jpg" alt="9jahotblog Verified Badge" style="width:25px;height:25px;vertical-align:middle;margin-right:5px;"></h3>
            <p>Earn for posting alone and receive higher earnings for massive engagements on your posts, making your writing efforts more rewarding.</p>

            <p>For custom verified badges, contact <a href="https://wa.me/+2349160331432">9jahotblog tech support</a> to join the waitlist. This service allows you to get a custom badge without the rigorous steps of obtaining it naturally and is endorsed by 9jahotblog. (You may have to sign up for this.)</p>
        </div>
    </section>

    <!-- Footer -->
    <footer id="footer">
        <ul class="icons">
            <li><a href="https://Twitter.com/koladhino" class="icon brands alt fa-twitter"><span class="label">Twitter</span></a></li>
            <li><a href="https://www.facebook.com/profile.php?id=100092154756974" class="icon brands alt fa-facebook-f"><span class="label">Facebook</span></a></li>
            <li><a href="https://Instagram.com/koladesworld" class="icon brands alt fa-instagram"><span class="label">Instagram</span></a></li>
            <li><a href="https://github.com/philipsmith617" class="icon brands alt fa-github"><span class="label">GitHub</span></a></li>
            <li><a href="mailto:9jahotblog2@gmail.com" class="icon solid alt fa-envelope"><span class="label">Email</span></a></li>
        </ul>
        <ul class="copyright">
            <li>&copy; 9jahotblog. All rights reserved.</li>
            <li>Design: <a href="https://wa.me/+2349160331432">Philip</a></li>
        </ul>
    </footer>
    <button id="dark-mode-toggle">ðŸŒ™</button>
</div>
</div>

<!-- Scripts -->
<script src="assets/js/jquery.min.js"></script>
<script src="assets/js/jquery.scrolly.min.js"></script>
<script src="assets/js/jquery.dropotron.min.js"></script>
<script src="assets/js/jquery.scrollex.min.js"></script>
<script src="assets/js/browser.min.js"></script>
<script src="assets/js/breakpoints.min.js"></script>
<script src="assets/js/util.js"></script>
<script src="assets/js/main.js"></script>
<script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-app.js";
    import { getAuth, onAuthStateChanged, signOut, updateProfile } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-auth.js";
    import { getFirestore, doc, getDoc, updateDoc } from "https://www.gstatic.com/firebasejs/10.12.4/firebase-firestore.js";

    const firebaseConfig = {
        apiKey: "AIzaSyCzajY4QIxiRiob2ho-Cgkj6EtOz83AzI8",
        authDomain: "jahotblog-login.firebaseapp.com",
        projectId: "jahotblog-login",
        storageBucket: "jahotblog-login.appspot.com",
        messagingSenderId: "661526730601",
        appId: "1:661526730601:web:27a3c1624ccd6f20ab8c16c"
    };

    const app = initializeApp(firebaseConfig);
    const auth = getAuth();
    const db = getFirestore(app);

    let currentPage = 0;
    const bookContent = [
        "<p><strong>LONE RANGER</strong></p><p><i>I shivered as the cool wind blew dust into my eyes. I'd come for a long run before dawn by the beach, but now, I was winded.</i></p><p>My life was a suffocating mess and I needed the breathing space, so I took a much needed sabbatical from my job.</p><p>I was a pro-life and pro-God activist, making me automatically the target of every anti-Christ organisation. It was a good thing I was a lone ranger, with no family since my parents disowned me years ago because of my faith. The way the world had gone haywire, turning normalcy upside down, I just wished the return of the Lord was closer.</p>",
        "<p>All sorts of debauchery had been legalised all on the claim of human liberty. But when it came to mentions of truth, one was tagged a fanatic and was blatantly persecuted. As I was. I had received lots of threats. The most recent one that forced me to take this retreat was the lawsuit I was faced with a particular celebrity.</p><p>A popular popstar had sued me for allegedly defaming her. Her lyrics were clearly satanic and I'd only expressed my displeasure at how young people were being indoctrinated by her songs.</p>",
        "<p><i>I lay exhausted on the wet sand, spread eagle as I watch the sky light up with colours of the rising sunâ€”pinks and oranges against a background of pale blue spotted with white fluffy clouds.</i></p><p>'Lord, I'm tired and exhausted. I don't think I can go on on this path. Everyone hates me. Can't you just come and take me home? Like right now.'</p><p>The voice of the Lord came softly on the wind.</p><p>'Those who wait upon me will renew their strengths. They will mount up with wings as eagles, they will run and not be weary, they will walk and not faint.'</p><p>I soaked in the word. I needed the reminder.</p>",
        "<p>A particular quote I'd read somewhere rang in my heart as I watched the crashing waves: <blockquote>'If you want to go fast go alone, but if you want to go far, go with others.'</blockquote></p><p>'Sam, there are many who haven't caved in to the system of this world. You need to find them and walk with them. Your lone ranger creed won't work anymore, son.'</p><p>As He spoke those words, I noticed a young brunette walking into the shallow waters with her surf board. She didn't seem to notice me and I was impressed that she wore a very modest swim suit as opposed to the bikini that was common place. I noticed the glint of the silver cross pendant she wore. I had a witness in my spirit that she was also a strong believer.</p>",
        "<p>She slid into the water and went under for such a long time that I panicked and considered diving in to rescue her from drowning.</p><p>Just as I was about to rise to her rescue, she came out sleek and wet, her face brimming with such joy and peace. I saw her clasp her hands in prayer and her lips moving. I watched her for a long time. She must have sensed my eyes because the moment she was done, she opened her eyes and looked straight at me with a beautiful smile.</p><p>'Go, speak to her,' the Lord's voice said.</p><p>'Lord? I'm ranting to you about my predicament. Asking you for a solution. Not this. I don't need a distraction right now.'</p><p>'She's the solution I'm providing you.'</p><p>I looked at the waves again as this nameless lady began to ride the next wave. I smiled, not minding one bit that God's choice for me was a gorgeous lady who was obviously crazily in love with Him and not ashamed to show it.</p><p><strong>AUTHOR: Praise Abraham</strong></p>"
    ];

    function updatePageContent() {
        document.getElementById("book-page").innerHTML = bookContent[currentPage];
    }

    document.getElementById("next-page").addEventListener("click", () => {
        if (currentPage < bookContent.length - 1) {
            currentPage++;
            updatePageContent();
        }
    });

    document.getElementById("prev-page").addEventListener("click", () => {
        if (currentPage > 0) {
            currentPage--;
            updatePageContent();
        }
    });

    updatePageContent(); // Initialize with the first page content

    function updateProgress(userId, newProgress) {
        const userRef = doc(db, "users", userId);
        updateDoc(userRef, {
            progress: newProgress
        }).then(() => {
            console.log("Progress updated successfully.");
        }).catch((error) => {
            console.error("Error updating progress:", error);
        });
    }

    function fetchNewPrompt() {
        const prompts = {
            "Christian fiction": ["Write about a miracle that changes a person's life.", "Describe a journey of faith."],
            "Racism": ["Describe a character's struggle against prejudice.", "Write about an event that challenges a community's beliefs."],
            "Fantasy": ["Create a world where magic is real.", "Describe a hero's quest to find a lost artifact."],
            "Science Fiction": ["Imagine a future where humans live on Mars.", "Write about a robot that gains consciousness."],
            "Mystery": ["Describe a detective solving a crime.", "Write about a person who finds a hidden treasure map."]
        };
        const genres = Object.keys(prompts);
        const randomGenre = genres[Math.floor(Math.random() * genres.length)];
        const randomPrompt = prompts[randomGenre][Math.floor(Math.random() * prompts[randomGenre].length)];
        return randomPrompt;
    }

    const suggestions = {
        "Once": "Once upon a time",
        "In": "In a land far away",
        "The": "The hero embarked on a journey",
        "I don't": "I don't know",
        "He is": "He is a brave warrior",
        "She was": "She was a kind soul",
        "They went": "They went on an adventure",
        "It was": "It was a dark and stormy night",
        "There is": "There is a secret door",
        "We can": "We can make it through",
        "A long": "A long time ago",
        "Far away": "Far away in a distant land",
        "In the": "In the beginning",
        "I am": "I am ready for the challenge"
    };

    document.getElementById("new-prompt-btn").addEventListener("click", () => {
        const newPrompt = fetchNewPrompt();
        document.getElementById("writing-prompt").innerText = newPrompt;
    });

    document.getElementById("writing-textbox").addEventListener("input", (event) => {
        const text = event.target.value;
        const words = text.trim().split(/\s+/);
        const lastWord = words[words.length - 1];
        const suggestion = suggestions[lastWord];
        if (suggestion) {
            event.target.value = text.slice(0, text.lastIndexOf(' ') + 1) + suggestion;
        }
        document.getElementById("word-count").innerText = `Word count: ${words.length}`;

        // Display congratulatory message based on word count
        let message = "";
        if (words.length >= 10) message = "Great start! Keep going.";
        if (words.length >= 50) message = "Impressive! You're on fire.";
        if (words.length >= 100) message = "Amazing! You're a true writer.";
        if (words.length >= 200) message = "Outstanding! Keep up the excellent work.";
        if (words.length >= 500) message = "Congratulations! You've written a masterpiece.";
        document.getElementById("congratulatory-message").innerText = message;
    });

    document.getElementById("publish-story").addEventListener("click", (event) => {
        event.preventDefault();
        const text = document.getElementById("writing-textbox").value;
        const words = text.trim().split(/\s+/);
        const wordCount = words.length;

        // Submit the form
        event.target.closest("form").submit();

        // Update progress in Firestore
        onAuthStateChanged(auth, (user) => {
            if (user) {
                updateProgress(user.uid, wordCount);
            }
        });
    });

    // Dark mode toggle with multiple colors
    let themeIndex = 0;
    const themes = ["#333", "#006400", "#FFD700", "#8B0000", "#0000CD", "#800080", "#FF69B4", "#FFA500"];
    function applyTheme(themeIndex) {
        document.body.style.backgroundColor = themes[themeIndex];
        document.body.style.color = themeIndex === 0 ? "#fff" : "#000";
        document.querySelectorAll('.profile-container, .writing-container, .book-reader-container, .library-container').forEach((element) => {
            element.style.backgroundColor = themes[themeIndex];
        });
    }

    document.getElementById("dark-mode-toggle").addEventListener("click", () => {
        themeIndex = (themeIndex + 1) % themes.length;
        applyTheme(themeIndex);
    });

    document.querySelectorAll('.theme-toggle').forEach((button) => {
        button.addEventListener("click", (event) => {
            themeIndex = (themeIndex + 1) % themes.length;
            event.currentTarget.closest('.profile-container, .writing-container, .book-reader-container, .library-container').style.backgroundColor = themes[themeIndex];
        });
    });

    // Authentication state observer
    onAuthStateChanged(auth, (user) => {
        if (user) {
            const userId = user.uid;
            document.getElementById("user-name").innerText = user.displayName;
            document.getElementById("user-email").innerText = user.email;
            document.getElementById("user-username").innerText = user.displayName;
            document.getElementById("profile-photo").src = user.photoURL;

            // Fetch user data from Firestore
            const userRef = doc(db, "users", userId);
            getDoc(userRef).then((doc) => {
                if (doc.exists()) {
                    const userData = doc.data();
                    document.getElementById("user-username").innerText = userData.username;
                    document.getElementById("user-email").innerText = userData.email;
                    document.getElementById("user-level").innerText = "9jahotblogger";
                } else {
                    console.log("No such document!");
                }
            }).catch((error) => {
                console.log("Error getting document:", error);
            });
        } else {
            window.location.href = "login-page.html";
        }
    });

    document.getElementById("logout").addEventListener("click", () => {
        signOut(auth).then(() => {
            window.location.href = "login-page.html";
        }).catch((error) => {
            console.error("Error signing out:", error);
        });
    });

    // Handle edit profile
    document.getElementById("edit-profile").addEventListener("click", () => {
        const newUsername = prompt("Enter new username:");
        const newEmail = prompt("Enter new email:");
        const newPhotoURL = prompt("Enter new photo URL:");

        if (newUsername && newEmail && newPhotoURL) {
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    updateProfile(user, {
                        displayName: newUsername,
                        email: newEmail,
                        photoURL: newPhotoURL
                    }).then(() => {
                        const userRef = doc(db, "users", user.uid);
                        updateDoc(userRef, {
                            username: newUsername,
                            email: newEmail,
                            photoURL: newPhotoURL
                        }).then(() => {
                            alert("Profile updated successfully!");
                            document.getElementById("user-name").innerText = newUsername;
                            document.getElementById("user-email").innerText = newEmail;
                            document.getElementById("profile-photo").src = newPhotoURL;
                        }).catch((error) => {
                            console.error("Error updating Firestore:", error);
                        });
                    }).catch((error) => {
                        console.error("Error updating profile:", error);
                    });
                }
            });
        }
    });

    async function callGoogleGeminiAI(userMessage) {
        const apiKey = 'AIzaSyCd_P4J5xgsXcyVaqUBtAHvhb1AWJUATvA'; // Replace with your actual API Key
        const endpoint = 'https://generativelanguage.googleapis.com/v1/models/gemini-1.0-pro:generateContent?key=AIzaSyCd_P4J5xgsXcyVaqUBtAHvhb1AWJUATvA'; // Hypothetical endpoint

        try {
            const response = await fetch(endpoint, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                    'Authorization': `Bearer ${apiKey}`
                },
                body: JSON.stringify({
                    message: userMessage
                })
            });

            if (!response.ok) {
                throw new Error(`HTTP error! status: ${response.status}`);
            }

            const data = await response.json();
            return data.reply;  // Adjust based on API response structure
        } catch (error) {
            console.error("Error communicating with AI:", error);
            return "Sorry, something went wrong.";
        }
    }
        document.getElementById("send-message").addEventListener("click", async () => {
        const userMessage = document.getElementById("chat-input").value;
        if (userMessage) {
            // Display user message
            document.getElementById("chat-messages").innerHTML += `<p><strong>You:</strong> ${userMessage}</p>`;
            document.getElementById("chat-input").value = '';

            const aiMessage = await callGoogleGeminiAI(userMessage);

            // Display AI message
            document.getElementById("chat-messages").innerHTML += `<p><strong>AI:</strong> ${aiMessage}</p>`;
            document.getElementById("chat-box").scrollTop = document.getElementById("chat-box").scrollHeight;
        }
    });
</script>
</div>
</body>
</html>
